function validURL(str) {
  var pattern = new RegExp(/^(https?):\/\/([a-zA-Z]|[0-9]|\.)*(\.[a-z]+|:[0-9]+)\/?([a-zA-Z]|\/|[0-9])*$/i)
  return !!pattern.test(str)
}

export let baseURL = 'API_BASE_URL'
if (!validURL(baseURL)) {
  baseURL = 'http://localhost:8080'
}

//helper function to send requests
function send({ method, path, data }) {
  const fetch = process.browser ? window.fetch : require('node-fetch').default

  const options = {
    method,
    mode: 'cors',
    credentials: 'include',
    headers: {
      'Content-Type': 'application/json'
    }
  }

  if (data) {
    options.body = JSON.stringify(data)
  }

  return fetch (`${ baseURL }/${ path }`, options)
}

export function get (path) {
  return send({ method: 'GET', path })
}

export function del (path) {
  return send({ method: 'DELETE', path })
}

export function post (path, data) {
  return send({ method: 'POST', path, data })
}

export function put (path, data) {
  return send({ method: 'PUT', path, data })
}
